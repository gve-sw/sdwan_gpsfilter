
<!DOCTYPE html>

<html>

<head>

    <title>vManage</title>

    <link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.7.3/leaflet.css" />

    <script src="http://cdn.leafletjs.com/leaflet-0.7.3/leaflet.js"></script> 

    <style>
        #map {
            width: 1360px;
            height:800px;
        }
</style>

</head>

<body>

    You can see all devices from region {{ region }}<br> <br>

    <p>
       <!–– {{ display }}

    </p>

    <div id="map"></div>

    <script>

        var mymap = L.map('map').setView([0, 0], 2);

        L.tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token={accessToken}', {
        attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors,  Imagery © <a href="https://www.mapbox.com/">Mapbox</a>',
        maxZoom: 18,
        id: 'mapbox.streets',
        accessToken: 'pk.eyJ1IjoiaGJhcmhvdW4iLCJhIjoiY2p1eHVwY3V3MHJlYzQzbzBsYXdxa2ZweCJ9.0uGMr78GliSzhgsVrMhnTg'
         }).addTo(mymap);

        
        var display = '{{ display }}';
        rdisplay = display.replace(/&quot;/g,'"')

        json = JSON.parse(rdisplay)
        //document.write(json)
        //document.write(rdisplay)
        //document.write(json[1].device)
        

        var n = 0;
        
        for(var item in json) {
            n++;
        }

        for (var i = 0; i < n; i++) {
            var marker = L.marker([json[i].GPS[0], json[i].GPS[1]]).addTo(mymap);
            marker.bindPopup(json[i].device).openPopup();
        }
        

        




    </script>

</body>

</html>